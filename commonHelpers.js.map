{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay.js","../src/js/index.js"],"sourcesContent":["import axios from 'axios';\n\nconst apiUrl = 'https://pixabay.com/api/';\nconst apiKey = '44463145-8dd3def1cdcb4fcdb78deec18';\n\nexport default class PixabayApi {\n  constructor() {\n    this.page = 1;\n    this.pageSize = 40;\n  }\n\n  async fetchImages(searchQuery) {\n    const response = await axios.get(apiUrl, {\n      params: {\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        key: apiKey,\n        q: searchQuery,\n        page: this.page,\n        per_page: this.pageSize,\n      },\n    });\n\n    return response.data;\n  }\n}\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\n\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport PixabayApi from './pixabay';\n\nconst pixabayApi = new PixabayApi();\n\nconst searchForm = document.querySelector('#search-form');\nconst loader = document.querySelector('.loader');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreButton = document.querySelector('.load-more');\n\nsearchForm.addEventListener('submit', onSearch);\nloadMoreButton.addEventListener('click', onLoadMore);\n\nlet searchQuery = '';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nasync function onSearch(e) {\n  e.preventDefault();\n\n  searchQuery = e.currentTarget.searchQuery.value.trim();\n\n  if (!searchQuery) {\n    return;\n  }\n\n  loader.classList.remove('hidden');\n  loadMoreButton.classList.add('hidden');\n\n  resetGallery();\n\n  pixabayApi.page = 1;\n\n  try {\n    const data = await pixabayApi.fetchImages(searchQuery);\n\n    if (data.totalHits === 0) {\n      throw new Error();\n    }\n\n    renderGalleryImages(data);\n\n    checkNextPage(data.totalHits);\n\n    iziToast.success({\n      title: 'Success',\n      message: `Hooray! We found ${data.totalHits} images.`,\n      position: 'topRight',\n    });\n  } catch (error) {\n    loader.classList.add('hidden');\n\n    iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there are no images matching your search query. Please try again.',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  e.target.reset();\n}\n\nasync function onLoadMore() {\n  loader.classList.remove('hidden');\n  pixabayApi.page += 1;\n\n  try {\n    const data = await pixabayApi.fetchImages(searchQuery);\n\n    renderGalleryImages(data);\n\n    checkNextPage(data.totalHits, true);\n  } catch (error) {\n    loadMoreButton.classList.add('hidden');\n    loader.classList.add('hidden');\n\n    iziToast.error({\n      title: 'Error',\n      message: 'No images found',\n      position: 'topRight',\n    });\n    return;\n  }\n}\n\nfunction checkNextPage(totalHits, showWarning = false) {\n  if (totalHits > pixabayApi.pageSize * pixabayApi.page) {\n    loadMoreButton.classList.remove('hidden');\n    return;\n  }\n\n  loadMoreButton.classList.add('hidden');\n\n  if (showWarning) {\n    iziToast.warning({\n      title: 'Warning',\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'topRight',\n    });\n  }\n}\n\nfunction renderGalleryImages(data) {\n  gallery.insertAdjacentHTML(\n    'beforeend',\n    data.hits\n      .map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) => {\n          return `<div class=\"photo-card\">\n        <a href=\"${largeImageURL}\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\">\n            <b>Likes</b>\n            <span>${likes}</span>\n          </p>\n          <p class=\"info-item\">\n            <b>Views</b>\n            <span>${views}</span>\n          </p>\n          <p class=\"info-item\">\n            <b>Comments</b>\n            <span>${comments}</span>\n          </p>\n          <p class=\"info-item\">\n            <b>Downloads</b>\n            <span>${downloads}</span>\n          </p>\n        </div>\n        </div>`;\n        }\n      )\n      .join('')\n  );\n\n  loader.classList.add('hidden');\n\n  lightbox.refresh();\n}\n\nfunction resetGallery() {\n  gallery.innerHTML = '';\n}\n"],"names":["apiUrl","apiKey","PixabayApi","searchQuery","axios","pixabayApi","searchForm","loader","gallery","loadMoreButton","onSearch","onLoadMore","lightbox","SimpleLightbox","e","resetGallery","data","renderGalleryImages","checkNextPage","iziToast","totalHits","showWarning","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}